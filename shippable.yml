language: node_js

node_js:
  - 4.3

env:
  global:


build:
  ci:
    - SUDO=$(which sudo) && $SUDO pip install awsebcli
    - $SUDO pip install --upgrade botocore

  on_success:
    - ./prepare_build_folder.sh
    - cd build
    - ls
    - eb init --profile default sample_node_eb_paas -r us-east-1 -p node.js
    - eb deploy sampleNodeEbPaas-env -r us-east-1

  post_ci:
    - docker commit $SHIPPABLE_CONTAINER_NAME 288971733297.dkr.ecr.us-east-1.amazonaws.com/debug:latest
    - docker push 288971733297.dkr.ecr.us-east-1.amazonaws.com/debug:latest

integrations:
  hub:
    - integrationName: "Amazon ECR - ttrahan"
      type: ecr
      branches:
        only:
          - tutorial
